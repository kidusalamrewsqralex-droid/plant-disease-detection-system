<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Plant Disease Detector</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>ğŸŒ± Plant Disease Detector</header>

  <main class="card">
    <h2>Upload a leaf image to detect its disease.</h2>
    <input id="fileInput" type="file" accept="image/*">
    <button id="predictBtn">ğŸ” Predict</button>
    <div id="preview"></div>
    <div id="result"></div>
  </main>

<script>
const fileInput = document.getElementById("fileInput");
const predictBtn = document.getElementById("predictBtn");
const resultDiv = document.getElementById("result");
const preview = document.getElementById("preview");

fileInput.addEventListener("change", () => {
  preview.innerHTML = "";
  const file = fileInput.files[0];
  if (file) {
    const img = document.createElement("img");
    img.src = URL.createObjectURL(file);
    img.style.maxWidth = "200px";
    preview.appendChild(img);
  }
});

predictBtn.addEventListener("click", async () => {
  if (!fileInput.files[0]) {
    alert("Please choose an image.");
    return;
  }

  const formData = new FormData();
  formData.append("file", fileInput.files[0]);

  predictBtn.disabled = true;
  predictBtn.innerText = "Predicting...";

  try {
    const res = await fetch("/predict", { method: "POST", body: formData });
    const data = await res.json();
    resultDiv.innerHTML = "<h3>Results:</h3>" + 
      data.predictions.map(p => `<p>${p.label}: ${(p.confidence*100).toFixed(2)}%</p>`).join("");
  } catch (err) {
    resultDiv.innerText = "Error: " + err.message;
  } finally {
    predictBtn.disabled = false;
    predictBtn.innerText = "ğŸ” Predict";
  }
});
</script>
</body>
</html>
